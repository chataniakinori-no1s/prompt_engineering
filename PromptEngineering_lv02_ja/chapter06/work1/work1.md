#### ワーク1: Difyをローカル環境に構築しよう 

管理部の塚本さんは、これまでたくさんのプロンプトを書いてきたあなたに以下の相談を投げかけてきました。
「社内規定とかマニュアルがあちこちに散らばってて、社員からの同じ質問に何度も答えるのが大変...Geminiがそのまま社員の質問に答えてくれるチャットボットになったりしないかな？」

さて、皆さん。この身近な課題、もしこれまで学んできたプロンプトの知識だけで解決するとしたら、どうしますか？
おそらく、就業規則のPDFをコピーしてGeminiに貼り付け、「この内容から質問に答えて」と指示する方法を考えるかもしれませんね。
しかし、その方法では、分厚いマニュアルすべてを一度に扱えなかったり、毎回情報を貼り付けたりする手間が発生し、根本的な解決にはなりません。
これは、プロンプトだけではAIという「賢い脳」に、あなたの会社の「知識」を恒久的に記憶させることができない、という限界を示しています。

そこで必要になるのが、AIと社内文書のような「知識（ナレッジ）」を常時接続しておく**「システム」**の発想です。
AIがいつでも参照できる専用のデータベースを持つことで、社員は自然な言葉で質問するだけで、正確な答えを得られるようになります。
「でも、システム開発なんて難しそう…」と思いますよね。ご安心ください。それを**ノーコード（プログラミング不要）**で実現できるのが、この章から学ぶ**Dify**です。
Difyを使うことで、AIアプリケーションが「ユーザーからの質問」「知識」「AI」をどう連携させて動いているのか、その**構造を理解しながら**、あなた自身の手で課題を解決するツールを構築できます。

このワークでは、まずこのDifyを動かすための環境構築と、AIの脳みそとなるGeminiモデルを利用するための準備を行います。準備が整えば、次のワーク2から早速、塚本さんの悩みを解決するチャットボット作りに挑戦していきましょう！

---

### 1.Difyのローカル環境構築

お使いのPC環境に合わせて、以下の手順でDifyの環境を構築してください。

#### Windows編 🪟

**1. システム要件の確認**
お使いのPCが以下の要件を満たしているか確認してください。
* **CPU**: 2コア以上
* **RAM**: 4GB以上
* **OS**: 64ビット版のWindows10、11 Home、Pro、Enterprise

**2. 必須ツールのインストール**
Difyを動かすには「Git」と「Docker Desktop」が必要です。

* **Gitのインストール**:
    1.  [Git公式サイト](https://git-scm.com/downloads)からインストーラーをダウンロードします。
    2.  インストーラーを実行し、基本的にはデフォルト設定のままインストールを進めます。
    3.  インストール後、コマンドプロンプトで `git -v` と入力し、バージョン情報が表示されればOKです。

* **Docker Desktopのインストール**:
    1.  [Docker公式サイト](https://www.docker.com/products/docker-desktop/)からインストーラーをダウンロードします。
    2.  インストーラーを実行し、画面の指示に従いインストールします。
    3.  完了後、PCを再起動してください。
    4.  Docker Desktopを起動し、利用規約に同意します（登録やアンケートはスキップ可）。

**3. Difyのセットアップ**
1.  **ソースコードの取得**:
    * Cドライブ直下などに `tool` といった名前で作業用のフォルダを作成します。
    * 作成したフォルダ内で、`Shift`キーを押しながら右クリックし、「PowerShellウィンドウをここで開く」を選択します。
    * 開いたPowerShellで以下のコマンドを実行します。
        ```bash
        git clone [https://github.com/langgenius/dify.git](https://github.com/langgenius/dify.git)
        ```

2.  **Difyの起動**:
    * 引き続きPowerShellで、以下のコマンドを順番に実行します。
        ```bash
        cd dify/docker
        cp .env.example .env
        docker compose up -d
        ```

**4. 動作確認**
ブラウザで `http://localhost/install` にアクセスします。 管理者アカウントを作成し、ログインできれば環境構築は成功です！

---

#### Mac編 🍎

**1. システム要件の確認**
* **CPU**: 2コア以上
* **RAM**: 4GB以上
（[システム設定] > [一般] > [情報]で確認できます）

**2. 必須ツールのインストール**
* **Git**:
    * ターミナルを開き、`git --version` と入力してバージョンが表示されればOKです。
    * もしインストールされていない場合は、表示される指示に従いコマンドラインデベロッパーツールをインストールしてください。

* **Docker Desktop**:
    * [Docker公式サイト](https://www.docker.com/products/docker-desktop/)からインストーラーをダウンロードします。
    * `Docker.dmg` を開き、Dockerアイコンを「Applications」フォルダにドラッグ＆ドロップします。
    * 起動後、利用規約に同意し、初期設定を完了させます。

**3. Difyのセットアップ**
1.  **ソースコードの取得**:
    * ターミナルを開き、`cd` コマンドで作業用フォルダに移動します。
    * 以下のコマンドを実行します。
        ```bash
        git clone [https://github.com/langgenius/dify.git](https://github.com/langgenius/dify.git)
        ```

2.  **Difyの起動**:
    * ターミナルで、以下のコマンドを順番に実行します。
        ```bash
        cd dify/docker
        docker compose up -d
        ```

**4. 動作確認**
ブラウザで `http://localhost/install` にアクセスします。 管理者アカウントを作成し、`http://localhost/` にアクセスしてDifyのダッシュボードが表示されれば成功です！

---

### 2. Google GeminiのAPIキー設定

Dify上で実際に文章を生成したり、質問に答えたりするためには、思考を担当するAIの「脳」、すなわち**LLM（大規模言語モデル）**が必要になります。

この講座では、Googleが提供する高性能なLLM「**Gemini**」を利用します。DifyからGeminiの能力を借りるためには、「**APIキー**」という一種の「合鍵」を取得し、Difyに登録する必要があります。APIキーは、Difyが「私は許可された利用者です」とGoogleに証明し、Geminiの機能を使わせてもらうための重要な情報です。

ここでは、そのAPIキーを無料で取得し、あなたのDify環境に設定するまでの手順を詳しく見ていきましょう。

---

#### Gemini APIキーの取得手順

まずは、GeminiのAPIキーを発行してくれる「Google AI Studio」にアクセスします。

1.  **Google AI Studioへアクセス**
    * Webブラウザで [Google AI Studio](https://aistudio.google.com/) を開きます。
    * 普段お使いのGoogleアカウントでログインしてください。

2.  **APIキーの作成**
    * 画面左側のメニューにある `[API キーを取得]` という項目をクリックします。
    * 新しい画面が開いたら、`[新しいプロジェクトでAPIキーを作成する]` というボタンをクリックします。これにより、あなたのAPIキーが生成されます。

3.  **APIキーのコピーと保管**
    * 画面に英数字の羅列からなるAPIキーが表示されます。これがあなたの「合鍵」です。
    * キーの右側にあるコピーアイコンをクリックして、キーをクリップボードにコピーします。
    * このキーは後でDifyに貼り付けるため、一時的にメモ帳などにペーストしておきましょう。
    > **【注意】**
    > APIキーは、パスワードのように重要な情報です。他人に教えたり、WebサイトやSNSなど、公開の場に貼り付けたりしないように注意してください。

---

#### DifyへのAPIキー設定手順

次に、取得したAPIキーをDifyに登録して、Geminiモデルを使えるようにします。

1.  **Difyの設定画面を開く**
    * Difyにログインし、`http://localhost/` のダッシュボード画面を開きます。
    * 画面の右上隅に表示されているあなたのアカウント名のアイコンをクリックすると、メニューが表示されます。
    * そのメニューの中から `[設定]` を選択してください。

2.  **モデル・プロバイダーを選択**
    * 設定画面の左側に並んでいるメニューの中から、`[モデル・プロバイダー]` をクリックします。
    * 利用可能なLLMの一覧（OpenAI, Gemini, Anthropicなど）が表示されますので、その中から `Gemini` を見つけます。

3.  **APIキーの貼り付けと保存**
    * Geminiの欄の右側にある `[セットアップ]` ボタンをクリックします。
    * 設定用の入力画面が表示されます。`API Key` と書かれた入力ボックスに、先ほどGoogle AI StudioでコピーしたAPIキーを貼り付けます。
    * 入力が終わったら、`[保存]` ボタンをクリックします。

保存後、モデル・プロバイダーの一覧でGeminiの欄に緑色のチェックマークが表示されれば、設定は正常に完了です。

これで、あなたのDifyアプリケーションは、GoogleのGeminiモデルと通信し、その賢い「脳」を利用する準備が整いました。次のワークから、このパワフルなAIを使って、実際に動くアプリケーションを作っていきましょう！

---
お疲れ様でした。これで環境構築は終了です。
次のワークでは、初めてのチャットボット作成について学んでいきましょう。
