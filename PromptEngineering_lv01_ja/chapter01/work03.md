# ワーク3: AIはなぜ賢く振る舞えるのか？ - その「頭脳」の仕組みを理解する

前のワークでは、AIが「確率に基づいて次の単語を予測している」ため、ハルシネーションが起きることを学びました。では、そもそもAIはどうやって「次の単語」を予測できるようになったのでしょうか？なぜ、単なる予測なのに、これほど自然な文章を生成できるのでしょうか？

このワークでは、AIの基本的な仕組みを理解することで、より効果的にAIを活用するための基礎知識を身につけます。

## サンプル課題

まず、あなたが使っているAIチャットに、以下の質問を投げかけてみましょう。AI自身が、自分の仕組みをどのように説明するか観察してみてください。

```
あなたはAIの専門家です。AI技術に詳しくないビジネスパーソンに説明するように、「Transformer」という技術がなぜ画期的なのかを、専門用語をなるべく使わずに、何かに例えて分かりやすく説明してください。
```

AIはどのような例え話をしてくれたでしょうか？このワークでは、その回答の背景にある技術的な仕組みを、実用的な観点から理解していきます。

## Point
このワークの目的は、技術的な詳細を暗記することではありません。AIがどのように動作し、どこに限界があるのかを理解することで、次章から学ぶプロンプトエンジニアリングの基礎を固めることが目標です。

## 解説

### 解説1: AIの仕組みを知ることで得られる3つのメリット

「技術的な仕組みなんて知らなくても使えるのでは？」と思うかもしれません。確かに基本的な使い方なら可能ですが、プロフェッショナルとしてAIを活用するなら、基本的な仕組みの理解は必須です。

1. **ハルシネーションへの対処法が分かる**
   前回学んだ「確率による予測」という仕組みをより深く理解することで、どのような場面でAIが間違えやすいかを予測し、適切に検証できるようになります。

2. **プロンプトが効く理由の土台を理解できる**
   AIがどのように文章を理解し、処理しているかを知ることで、「なぜ詳細な指示が必要なのか」「なぜ文脈の提供が重要なのか」という疑問への答えが見えてきます。この理解は、次章から学ぶプロンプトエンジニアリングの技術を習得する上での重要な土台となります。

3. **クライアントへの説明力が向上する**
   「AIってどういう仕組みなの？」という質問に、専門用語を使わずに分かりやすく答えられることは、コンサルタントとしての信頼性を高めます。

### 解説2: AIが賢くなる仕組み - 「自己教師あり学習」

前回のワークで、AIは「次に来る確率が最も高い単語を予測している」と学びました。では、AIはどうやってその予測能力を身につけたのでしょうか？

その答えが**「自己教師あり学習（Self-Supervised Learning）」**です。これは、AIが人間の教師なしに、自分で学習する方法です。

具体的な仕組みを見てみましょう。AIは、インターネット上の文章から自動的に学習問題を作ります。

例：「生成AIはとても便利だ」という文章から
- **問題**: 「生成AIはとても `[MASK]` だ」
- **答え**: 便利

AIは、この穴埋め問題を何十億回も解くことで、単語の使われ方や文章のパターンを学習します。重要なのは、この問題と答えをAI自身が自動的に作り出している点です。人間が一つ一つ教える必要がないため、膨大な量のデータから効率的に学習できるのです。

この学習方法により、AIは文法、単語の意味、さらには一般的な知識まで、データから自動的に抽出して学習します。ただし、前回学んだように、これはあくまで「パターンの学習」であり、真の理解ではないことに注意が必要です。

**プロンプトとの関連**：この学習方法を理解すると、なぜAIが「曖昧な指示」よりも「具体的な指示」に対してより良い回答を返すのかが見えてきます。AIは学習した膨大なパターンの中から、与えられた文脈に最も適合するパターンを選んで回答を生成するからです。

### 解説3: 文脈を理解する仕組み - 「Transformer」と「Attention」

AIが自然な文章を生成できる理由は、**「Transformer（トランスフォーマー）」**という技術にあります。2017年に登場したこの技術が、ChatGPTのような高性能なAIを可能にしました。

Transformerの核心は**「Attention（アテンション）機構」**です。これは、文章中のどの部分が重要で、どの単語同士が関連しているかを判断する仕組みです。

例を見てみましょう：
> 彼女は銀行の窓口に行き、**それ**を預けた。

この「それ」が何を指すか理解するために、AIは文章全体を分析します。「銀行」「窓口」「預けた」という単語の関連性から、「それ」は「お金」や「通帳」を指していると判断します。

従来の技術では文章を頭から順番に処理していたため、長い文章では最初の内容を忘れてしまう問題がありました。しかし、Transformerは文章全体を同時に処理し、すべての単語の関係性を把握できます。これにより、長い文章でも文脈を正確に理解できるようになったのです。

**プロンプトとの関連**：この「文脈を理解する力」は、プロンプトエンジニアリングにおいて極めて重要です。例えば、次のような違いを考えてみましょう。

曖昧な指示：「以下の技術文書を要約して」
明確な指示：「以下の技術文書を、経営層向けに3つのポイントで要約して」

Transformerの仕組みを理解していれば、なぜ後者の方が指示者の望んでいる結果につながりやすいかが分かります。AIは「経営層向け」「3つのポイント」という文脈情報を手がかりに、学習したパターンの中から最適な回答形式を選択できるからです。

次章から学ぶプロンプトエンジニアリングでは、このAIの特性を活かした様々なテクニックを習得していきます。

### サンプル課題解答

AIにTransformerの説明を求めた場合の回答例：

> Transformerは、非常に優秀な「同時通訳チーム」のようなものです。
> 
> 従来のAI技術は、一人の通訳者が文章を頭から順番に訳していくようなものでした。長い文章では、最初の内容を忘れてしまうことがありました。
> 
> 一方、Transformerは、チーム全員がまず文章全体を読み、「この単語とこの単語は関連が深い」という関係性を把握してから翻訳を始めます。例えば、「彼は銀行に行った」という文なら、「彼」と「行った」、「銀行」と「行った」の関係を数値化して理解します。
> 
> この方法により、文脈を正確に捉えた自然な文章生成が可能になり、ChatGPTのような対話型AIが実現したのです。

---

## 練習問題

学んだ内容を確認するため、AIに以下の指示を出してみましょう。

```
あなたは教育の専門家です。小学生にもわかるように、「自己教師あり学習」というAIの勉強方法を、身近なものに例えて説明してください。
```

### ヒント
AIが自分で問題を作って解くという「自発的な学習」の特徴を、小学生の日常生活に置き換えて説明してもらいましょう。「自分で問題集を作る」「図書館の本を全部読む」などの例えが考えられます。

### 練習問題解答例

> こんにちは！AIがどうやって賢くなるか、説明するね。
>
> みんなは学校で、先生が「これが答えだよ」って教えてくれるよね。でも、AIの勉強方法は違うんだ。
>
> AIは、図書館にある本を全部読んで、自分でクイズを作るんだ。
>
> **自分でクイズを作る**
> 「ぼくは、りんごをたべた」という文を見つけたら、「たべた」を隠して「ぼくは、りんごを＿＿」というクイズにする。
>
> **自分で答え合わせ**
> そして、元の文章を見て「『たべた』が正解だ！」と確認する。
>
> これを何億回も繰り返すことで、言葉の使い方を覚えていくんだ。先生がいなくても自分で勉強できる、すごい方法だよね！

## 発展問題

AIの学習方法には課題もあります。以下の質問をAIに投げかけて、その問題点を理解しましょう。

```
あなたはAI倫理の専門家です。「自己教師あり学習」が、インターネット上のデータから学ぶことによって生じる「偏見（バイアス）」の問題について、中学生にも分かるように説明してください。
```

### ヒント
インターネット上には、偏った意見や古い情報、差別的な表現も存在します。AIはこれらを区別せずに学習してしまうため、「看護師は女性」「エンジニアは男性」といったステレオタイプを学習してしまう可能性があります。この問題は、プロンプトを書く際にも意識すべき重要なポイントです。

---

## まとめ：プロンプトエンジニアリングへの架け橋

お疲れ様でした。これでAIの基本的な動作原理を理解できました。

このワークで学んだことを振り返ってみましょう：

1. **自己教師あり学習**：AIは膨大なデータから自動的にパターンを学習する
2. **Transformer**：文章全体の文脈を同時に理解し、単語間の関係性を把握する
3. **Attention機構**：重要な情報に注目し、文脈に応じた適切な回答を生成する

次章から始まるプロンプトエンジニアリングでは、これらのAIの特性を最大限に活用するための具体的な技術を学んでいきます。「役割の設定」「具体例の提示」「段階的な思考の促進」など、様々なテクニックがなぜ効果的なのか、今回学んだ知識があれば深く理解できるでしょう。

AIは単なる検索エンジンではなく、文脈を理解し、パターンを組み合わせて回答を生成する高度なシステムです。この理解を持って次章に進むことで、あなたはより効果的なプロンプトを作成し、AIの能力を最大限に引き出せるようになるでしょう。
