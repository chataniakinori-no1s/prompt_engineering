---
seq: 60
title: 新たなクレームに高度なプロンプト戦略で挑む
slug: chapter05/work46
description: これまでに学んだステップバック、メタ認知、自己検証のスキルを総動員した実践的な課題に取り組む
type: practice
relation: chapter05/index,chapter05/work36,chapter05/work39,chapter05/work42
difficulty: 4
displayLanguage: ja
duration: 20
---

# 【実践課題】新たなクレームに高度なプロンプト戦略で挑む
## 解決策の品質を高める (メタ認知の応用)

:::exercise

**【あなたのタスク】**
ステップバックによる分析の結果、複数の技術的アプローチが考えられることが分かりました。高橋さんは、その中でも最も現実的な「ユーザー辞書機能」を実装する方針を固め、その基本的なデータベース設計をAIに依頼しました。

**▼ AIが提案したDBスキーマ（初稿）**

```sql
CREATE TABLE user_dictionaries (
    id INT PRIMARY KEY AUTO_INCREMENT,
    user_id INT NOT NULL,
    source_term VARCHAR(255) NOT NULL,
    target_term VARCHAR(255) NOT NULL
);
```

このスキーマはシンプルですが、高橋さんは「大量の辞書データが登録された時のパフォーマンスは？」「単語だけでなく、複数の単語からなるフレーズには対応できるのか？」といった、エンジニアならではの懸念を抱きました。
:::

:::Hint

ワークで学んだ**「メタ認知」**を使い、AIに自らの提案をレビューさせましょう。AIが作ったシンプルな設計案は、時として非機能要件（パフォーマンス、拡張性など）の考慮が浅いことがあります。そこでAIに**「大規模サービスの運用経験が豊富な、データベース管理者（DBA）」**という役割を与えます。「このDBスキーマ設計について、パフォーマンスと拡張性の観点から、考えられる問題点を3つ指摘してください」と問いかけることで、AIは自ら考慮漏れを発見し、より堅牢な設計を考えるきっかけを与えてくれます。
:::

<details>
<summary>【実践課題】プロンプト例とAI回答出力例</summary>

### ▼ 課題2プロンプト例

```markdown
このDBスキーマ設計案をありがとうございます。

CREATE TABLE user_dictionaries (
    id INT PRIMARY KEY AUTO_INCREMENT,
    user_id INT NOT NULL,
    source_term VARCHAR(255) NOT NULL,
    target_term VARCHAR(255) NOT NULL
);

では次に、あなた自身がこのDBスキーマをレビューする、大規模サービスの運用経験が豊富なデータベース管理者（DBA）の立場で、この設計を評価してください。

パフォーマンスと拡張性の観点から、このシンプルな設計が将来的に引き起こす可能性のある問題点を3つ指摘してください。
```

### ▼ 課題2 AI回答出力例

```
承知いたしました。DBAとして、このスキーマ設計の潜在的な問題点を指摘します。

**1. 複合インデックスの欠如によるパフォーマンス劣化**
- **問題点**: 現在の設計では、`user_id`と`source_term`で検索するクエリが多発すると予想されますが、`id`にしか主キーインデックスがありません。`source_term`だけで検索するケースは少なく、多くは「特定のユーザーの、特定の単語」を探すはずです。このままでは、`user_id`で絞り込んだ後、`source_term`でテーブルをフルスキャンする非効率なクエリが実行される可能性があります。
- **推奨**: `(user_id, source_term)`の複合インデックスを追加すべきです。

**2. `VARCHAR(255)`の非効率性**
- **問題点**: `source_term`は単語だけでなく、複数の単語からなるフレーズ（例：「人工知能学会」）が登録される可能性があります。`VARCHAR(255)`では長さが足りなくなるケースが考えられます。逆に、ほとんどが短い単語である場合、この固定長の定義はディスクスペースの無駄遣いになる可能性もあります。
- **推奨**: `TEXT`型への変更を検討するか、あるいは`source_term`の最大長を要件として明確に定義すべきです。

**3. テナント（企業）単位でのデータ管理の考慮漏れ**
- **問題点**: この設計はユーザー個人に辞書が紐付いていますが、B2Bサービスでは「企業単位」で辞書を共有したいという要求が必ず出てきます。現状のままでは、企業内の全ユーザーが同じ単語をそれぞれ登録する必要があり、非効率かつ管理が煩雑になります。
- **推奨**: `user_id`だけでなく`tenant_id`（企業ID）もカラムに追加し、辞書を企業単位で管理できるような拡張性を考慮した設計にすべきです。

```


