---
seq: 13
title: ワーク3: 段階的思考の誘導（Chain of Thought）
slug: chapter03/work3_cot
description: AIの思考プロセスを段階的に誘導するChain of Thoughtプロンプティングを学ぶ
type: work
relation: chapter03/index,chapter03/work1_persona,chapter03/work2_few_shot
difficulty: 3
displayLanguage: ja
duration: 25
---

# ワーク3: 段階的思考の誘導（Chain of Thought）

## サンプル課題
プロダクトマネージャーの田中さんは、新機能「AIアシスタント」のベータテスト中に、重大なバグ報告を受け取りました。

> **田中さんのお悩み:**
> 「テスターから、『特定の操作をすると、AIアシスタントの応答が極端に遅くなる』という報告があった。原因がデータベースなのか、ネットワークなのか、それともAIモデル自体の問題なのか、考えられる要因が複雑に絡み合っていて、どこから調査すればいいか分からない…。」

この複雑な問題のボトルネックを特定するために、AIに段階的に原因を推論させるChain of Thoughtパターンを活用してみましょう。

## 解説

### Chain of Thought (CoT) とは？

Chain of Thought（CoT）、日本語で「思考の連鎖」とは、AIに最終的な答えだけでなく、そこに至るまでの中間的な思考ステップを順序立てて出力させるプロンプト技術です。

複雑な問題や多段階の推論が必要なタスクに対して、CoTを用いることでAIは問題を小さなステップに分解して考えるようになります。これにより、計算ミスや論理の飛躍が減り、最終的な回答の精度が劇的に向上します。

:::_ Point(なぜCoTは有効なのか？)
人間が難しい問題を解くとき、いきなり答えを出そうとせず、情報を整理したり、原因を仮説立てしたり、段階を踏んで考えます。CoTは、AIにこの人間的な思考プロセスを模倣させることで、より深く、正確な答えを導き出すためのテクニックです。
:::

### CoTを促すプロンプト

CoTをAIに実行させるのは非常に簡単です。プロンプトの最後に、以下のような「魔法の言葉」を追加するだけです。

- 「ステップバイステップで考えてください。」
- 「思考の過程を説明してください。」
- 「順を追って説明してください。」

これらの指示により、AIは答えを出す前に、どのようにその結論に至ったかの論理的な道筋を示してくれます。

### CoTをさらに活用する：思考の「型」を与える
「ステップバイステップで考えて」という指示は強力ですが、今回の原因分析のように、より構造的なアウトプットが欲しい場合は、AIに**思考の「型」**、つまり**分析のフレームワーク**そのものを与えることで、さらにアウトプットの質をコントロールできます。

例えば、今回の田中さんの課題では、単にAIに自由に分析させるのではなく、
1.  **データベースの問題**
2.  **ネットワークの問題**
3.  **AIモデルの問題**

というように、調査すべき原因の候補を順番に考察させるという思考のプロセスそのものを指示として与えます。これにより、AIは私たちの思考プロセスに沿って、網羅的で論理的な分析結果を出力してくれるのです。

#### Warning
CoTは非常に強力ですが、万能ではありません。AIが間違った前提で思考を始めると、その後のステップもすべて間違ってしまう可能性があります。出力された思考の過程を鵜呑みにせず、人間がきちんとチェックすることが重要です。

### サンプル課題解答
```
あなたは、大規模Webアプリケーションのトラブルシューティングを専門とする、経験豊富なSRE（Site Reliability Engineer）です。
現在、私が担当する新機能「AIアシスタント」で、特定の操作をすると応答が極端に遅くなるという問題が発生しています。

考えられる原因を特定するため、以下の思考プロセスに従って、あなたの考察を報告してください。

# 思考プロセス
1.  まず、「データベース」に問題がある可能性を検討してください。どのような状況が考えられますか？
2.  次に、「ネットワーク」に問題がある可能性を検討してください。どのような状況が考えられますか？
3.  最後に、「AIモデル自体」に問題がある可能性を検討してください。どのような状況が考えられますか？

ステップバイステップで、論理的に考えてください。
```

**▼ AIによる出力例**
```
承知いたしました。SREとして、ご報告いただいたパフォーマンス低下の問題について、ステップバイステップで原因を考察します。

**ステップ1：データベースの問題の可能性**

まず、データベース起因のボトルネックを疑います。
特定の操作で応答が遅くなるということから、その操作が複雑なデータベースクエリを発行している可能性があります。例えば、大量のJOINや、インデックスが効いていないカラムでの検索が実行されている場合、応答時間は著しく悪化します。また、特定の操作によってデータベースの接続コネクションを使い果たし、後続の処理が待たされている可能性も考えられます。

**ステップ2：ネットワークの問題の可能性**

次に、ネットワーク遅延の可能性を検討します。
AIアシスタントが外部のAIモデルAPI（例えばOpenAI APIなど）を利用している場合、そのAPIサーバーとの通信経路で遅延が発生している可能性があります。あるいは、社内ネットワークからクラウド環境への通信帯域が、特定の操作によって発生する大量のデータ転送によって逼迫していることも考えられます。

**ステップ3：AIモデル自体の問題の可能性**

最後に、AIモデル自体が原因である可能性を考察します。
特定の操作が、AIモデルにとって非常に複雑で、推論に時間のかかるプロンプトを生成している可能性があります。例えば、非常に長い文脈を要約させたり、難解な専門知識に関する回答を生成させたりする場合、モデルの思考時間（推論時間）が長くなり、結果として応答が遅くなることがあります。これは、モデルの性能限界や、プロンプトの設計に起因する問題と考えられます。
```

---
### 練習問題1
**【シチュエーション】**
あなたは、マーケティング部の担当者です。先月実施したWeb広告キャンペーンの結果を分析し、費用対効果（ROI）を算出するよう上司から指示されました。手元には、各広告媒体の出稿費用と、そこから得られた売上データがあります。

> **【キャンペーンデータ】**
> - **Google広告**: 費用 30万円, 売上 90万円
> - **Facebook広告**: 費用 20万円, 売上 50万円
> - **キャンペーン全体の総人件費**: 10万円

さあ、実際にChatGPTやGeminiなどの対話AIを使って、このキャンペーンの最終的なROI（投資利益率）を計算させるプロンプトを作成してみましょう。

### Hint
ROIの計算式は `(利益 ÷ 投資額) × 100` ですが、AIにいきなり「ROIを計算して」と頼むと、途中の計算を間違える可能性があります。「総売上を計算する」「総投資額を計算する」「利益を計算する」「最後にROIを計算する」というように、思考のステップをAIに指示してあげることが、正確な答えへの近道です。

### 練習問題1プロンプト例
```
あなたは、優秀なデータアナリストです。
以下のキャンペーンデータを用いて、最終的なROI（投資利益率）を算出してください。

# キャンペーンデータ
- Google広告: 費用 30万円, 売上 90万円
- Facebook広告: 費用 20万円, 売上 50万円
- キャンペーン全体の総人件費: 10万円

# 指示
以下のステップで、順を追って計算してください。
1.  まず、キャンペーンの総売上を計算します。
2.  次に、広告費と人件費を合計した、総投資額を計算します。
3.  そして、総売上から総投資額を引いて、利益を計算します。
4.  最後に、ROIの計算式（(利益 / 投資額) * 100）を使って、最終的なROIを算出します。

ステップバイステップで考えてください。
```

### 練習問題1AI回答出力例
（AIによる回答のイメージ）
```
承知いたしました。データアナリストとして、キャンペーンのROIをステップバイステップで算出します。

**ステップ1：総売上の計算**
各広告媒体からの売上を合計します。
90万円（Google広告） + 50万円（Facebook広告） = 140万円
総売上は **140万円** です。

**ステップ2：総投資額の計算**
各広告媒体の費用と総人件費を合計します。
30万円（Google広告） + 20万円（Facebook広告） + 10万円（人件費） = 60万円
総投資額は **60万円** です。

**ステップ3：利益の計算**
総売上から総投資額を引きます。
140万円 - 60万円 = 80万円
利益は **80万円** です。

**ステップ4：最終的なROIの算出**
計算式 `(利益 ÷ 投資額) × 100` に当てはめます。
(80万円 ÷ 60万円) × 100 = 133.33...%

最終的なROIは **約133.3%** です。
```

---
### 練習問題2
**【シチュエーション】**
あなたは、人事部の採用担当者です。あるポジションに3人の最終候補者（Aさん, Bさん, Cさん）が残っており、それぞれの評価をまとめたメモを元に、誰を採用すべきか最終的な結論を出したいと考えています。

> **【候補者の評価メモ】**
> - **Aさん**: 技術スキルは3人の中で最も高い。しかし、面接では少しコミュニケーションに課題が見られた。
> - **Bさん**: 技術スキルは標準的だが、コミュニケーション能力が非常に高く、チームの雰囲気を良くしてくれそうだ。
> - **Cさん**: スキルもコミュニケーション能力も平均的。ただ、業界への熱意と学習意欲が誰よりも強いことが印象的だった。
> - **採用方針**: 今回のポジションでは、短期的な即戦力性よりも、長期的にチームに貢献し、成長してくれるポテンシャルを重視したい。

さあ、実際にChatGPTやGeminiなどの対話AIを使って、この情報から最も採用すべき人物を論理的に選定させるプロンプトを作成してみましょう。

### Hint
AIに結論だけを求めると、短絡的な答えが返ってくるかもしれません。「各候補者の長所と短所を整理する」「採用方針と各候補者を照らし合わせる」「最終的な結論とその理由を述べる」という思考のステップを指示することで、AIはより深く、説得力のある結論を導き出してくれます。

### 練習問題2プロンプト例
```
あなたは、経験豊富な採用マネージャーです。
以下の3人の最終候補者の情報と、当社の採用方針を元に、誰を最も採用すべきか、あなたの推薦を報告してください。

# 候補者の評価メモ
- Aさん: 技術スキルは3人の中で最も高い。しかし、面接では少しコミュニケーションに課題が見られた。
- Bさん: 技術スキルは標準的だが、コミュニケーション能力が非常に高く、チームの雰囲気を良くしてくれそうだ。
- Cさん: スキルもコミュニケーション能力も平均的。ただ、業界への熱意と学習意欲が誰よりも強いことが印象的だった。

# 採用方針
今回のポジションでは、短期的な即戦力性よりも、長期的にチームに貢献し、成長してくれるポテンシャルを重視したい。

# 指示
以下のステップで、論理的に考察してください。
1.  まず、各候補者の長所と短所を整理します。
2.  次に、当社の採用方針と各候補者の特性を照らし合わせ、誰が最も方針に合致するかを評価します。
3.  最後に、最終的な結論として、あなたが最も推薦する候補者とその理由を明確に述べてください。

ステップバイステップで考えてください。
```

### 練習問題2AI回答出力例
（AIによる回答のイメージ）
```
承知いたしました。採用マネージャーとして、いただいた情報に基づき、最適な候補者を推薦します。

**ステップ1：各候補者の長所と短所の整理**

* **Aさん**:
    * 長所: 高い技術スキル（即戦力）
    * 短所: コミュニケーション能力への懸念
* **Bさん**:
    * 長所: 非常に高いコミュニケーション能力、チームへの好影響
    * 短所: 技術スキルは標準的
* **Cさん**:
    * 長所: 非常に高い熱意と学習意欲（ポテンシャル）
    * 短所: スキル、コミュニケーション能力ともに平均的

**ステップ2：採用方針との照らし合わせ**

当社の採用方針は「短期的な即戦力性よりも、長期的な貢献と成長ポテンシャルを重視する」です。
この方針に照らすと、
-   Aさんは「即戦力性」の点では魅力的ですが、「長期的な貢献」の基盤となるチームワーク面で懸念が残ります。
-   Bさんはチームへの貢献という点では非常に魅力的ですが、ポテンシャルという観点ではCさんほどではありません。
-   Cさんは現時点でのスキルは平均的ですが、「高い熱意と学習意欲」は、まさに「成長ポテンシャル」そのものであり、長期的にチームへ大きく貢献してくれる可能性を最も秘めています。

**ステップ3：最終的な結論と推薦理由**

以上の考察から、私は **Cさん** を最も強く推薦します。

理由は、当社の「ポテンシャル重視」という採用方針に最も合致する候補者だからです。技術スキルは入社後に学習可能ですが、Cさんが持つような強い熱意と学習意欲は、教えることが難しい本質的な資質です。彼（彼女）のポテンシャルに投資することこそが、長期的な視点で見れば、チームと会社にとって最大の利益となると確信しています。
```

---
お疲れ様でした。これでこのワークは終了です。
次のワークでは、AIに質問させることで、こちらの意図をより深く理解させる対話術について学んでいきましょう。
